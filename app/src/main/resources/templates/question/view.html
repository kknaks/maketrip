<!DOCTYPE html>
<html>
<head data-th-replace="~{header :: head}">
</head>
<header data-th-replace="~{header :: #page-header}"></header>
<h1 class="text-center mb-4">ÏùºÏ†ï ÏßàÎ¨∏ Í≤åÏãúÌåê</h1>

<body>
<div class="container my-5" style="max-width: 1200px; margin: 0 auto;">

    <form id="myForm" action="view2" method="post" enctype="multipart/form-data">
        <input type="hidden" name="boardNo" data-th-value='${board.boardNo}'>

        <div class="mb-3">
            <h2 class="form-title" style="margin-left: 10px; font-size: 1.8rem; font-weight: bold;" data-th-text="${board.boardTitle}">Ï†úÎ™©</h2>
        </div>

        <div data-th-if="${board}" class="border-bottom pb-3 mb-1">
            <div class="d-flex align-items-center mb-3">
                <img data-th-src="${board.writer.userPhoto != null ? board.writer.userPhoto : 'https://via.placeholder.com/60x60'}"
                     alt="User Photo" class="rounded-circle me-3" style="width: 60px; height: 60px;">
                <div>
                    <h5 class="mb-1" data-th-text="${board.writer.userNickname}">ÎãâÎÑ§ÏûÑ</h5>
                    <small class="text-muted">
                        ÏûëÏÑ±Ïùº: <span data-th-text="${#calendars.format(board.boardCreatedDate, 'yyyy.MM.dd HH:mm')}">ÎÇ†Ïßú</span>
                        ‚Ä¢ Ï°∞Ìöå: <span data-th-text="${board.boardCount}">Ï°∞ÌöåÏàò</span>
                    </small>
                </div>
                <div class="ms-auto">
                    <button type="button" class="btn btn-outline-secondary btn-sm" data-th-if="${isUserAuthorized}" data-th-onclick="document.getElementById('myForm').submit();">ÏàòÏ†ï</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" data-th-if="${isUserAuthorized}" data-th-onclick="|if(confirm('Í≤åÏãúÍ∏ÄÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))location.href='@{delete(boardNo=${board.boardNo})}'|">ÏÇ≠Ï†ú</button>
                </div>
            </div>

            <!-- Ï¢ãÏïÑÏöî Î∞è Ï¶êÍ≤®Ï∞æÍ∏∞ Î≤ÑÌäº -->
            <div class="d-flex align-items-center" >
                <button type="button" id="likeButton" class="btn btn-outline-danger btn-sm me-2"
                        data-th-onclick="|toggleLike(${board.boardNo})|"
                        data-th-text="${isLiked != null and isLiked ? '‚ù§Ô∏è Ï¢ãÏïÑÏöî Ï∑®ÏÜå' : 'ü§ç Ï¢ãÏïÑÏöî'}"></button>
                <span id="likeCount" class="me-3" data-th-text="${board.boardLike}">0</span>

                <button type="button" id="favorButton" class="btn btn-outline-warning btn-sm me-2"
                        data-th-onclick="|toggleFavor(${board.boardNo})|"
                        data-th-text="${isFavored != null and isFavored ? '‚≠ê Ï¶êÍ≤®Ï∞æÍ∏∞ Ï∑®ÏÜå' : '‚ö™ Ï¶êÍ≤®Ï∞æÍ∏∞'}"></button>
                <span id="favorCount" data-th-text="${board.boardFavor}">0</span>
            </div>
        </div>

        <div class="container my-3">
            <div data-th-each="trip : ${trips}" data-th-object="${trip}">
                <h4 class="mb-2" style="margin-left: 10px; font-size: 1.5rem;">Ï†ÑÏ≤¥ Í≤ΩÎ°ú</h4>
                <p class="text-muted mb-3" style="margin-left: 10px; font-size: 0.9rem;" data-th-text="${#dates.format(trip.startDate, 'yyyy.MM.dd(E)')} + ' ~ ' + ${#dates.format(trip.endDate, 'yyyy.MM.dd(E)')}">2024.09.18(Ïàò) ~ 2024.09.21(ÌÜ†)</p>
            </div>

<!--            <div class="d-flex" style="overflow-x: auto; white-space: nowrap;">-->
            <div class="d-flex" style="overflow-x: auto; overflow-y: auto; white-space: nowrap; height: 500px;"> <!-- Í∞ÄÎ°ú Î∞è ÏÑ∏Î°ú Ïä§ÌÅ¨Î°§ -->
                <div class="col-md-4 mb-3 d-inline-block" style="width: 300px; margin-right: 20px;" data-th-each="entry : ${groupedSchedules}">
                    <h5 class="mb-3 text" style="font-size: 1.2rem;" data-th-text="${entry.key} + 'ÏùºÏ∞®'">ÏùºÏ∞®</h5>

                    <div class="timeline">
                        <div class="timeline-item mb-1" data-th-each="schedule, iter : ${entry.value}" data-th-object="${schedule}">
                            <div class="p-3 border rounded shadow-sm d-flex justify-content-between align-items-center">
                                <!-- ÏùºÏ†ï Ï†ïÎ≥¥ -->
                                <div class="me-2 align-items=start">
                                    <div class="d-flex">
                                        <div class="badge bg-warning text-white" style="font-size: 1rem; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center;" data-th-text="${iter.index + 1}">ÏùºÏ†ï ÏàúÏÑú</div>
                                        <div class="ms-2">
                                            <p class="mb-1 text-primary" style="font-size: 0.9rem;" data-th-text="*{location.locationName}">ÏßÄÏó≠</p>
                                            <p class="mb-1 text-primary" style="font-size: 0.9rem;" data-th-text="*{location.locationName}">ÏßÄÏó≠</p>
                                            <p class="mb-1 text-primary" style="font-size: 0.9rem;" data-th-text="*{location.locationName}">ÏßÄÏó≠</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Ïù¥ÎØ∏ÏßÄ -->
                                <div>
                                    <img data-th-src="${schedule.location.locationPhoto != null ? schedule.location.locationPhoto : 'https://via.placeholder.com/70x70'}"
                                         alt="Location Photo" class="img-thumbnail" style="width: 70px; height: 70px;">
                                </div>
                            </div>
                            <!-- ÌÉÄÏûÑÎùºÏù∏ Ï†êÏÑ†Í≥º ÏãúÍ∞Ñ Ï†ïÎ≥¥ -->
                            <div class="d-flex align-items-center" style="height: 20px;">
                                <div class="timeline-line mt-2" style="border-left: 2px dotted #ddd; height: 70%; margin-left: 15px;"></div>
                                <div class="text-muted small ms-2" style="font-size: 0.8rem; margin-top: 6px;"><i class="bi bi-car-front"></i> 45Î∂Ñ</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<!--                <div class="container my-5">-->
<!--                    <div data-th-each="trip : ${trips}" data-th-object="${trip}">-->
<!--                        <h4 class="mb-2" style="margin-left: 10px;">Ï†ÑÏ≤¥ Í≤ΩÎ°ú</h4>-->
<!--                        <p class="text-muted mb-3" data-th-text="${#dates.format(trip.startDate, 'yyyy.MM.dd(E)')} + ' ~ ' + ${#dates.format(trip.endDate, 'yyyy.MM.dd(E)')}">2024.09.18(Ïàò) ~ 2024.09.21(ÌÜ†)</p>-->
<!--                    </div>-->

<!--                    <div style="overflow-x: auto; white-space: nowrap;"> &lt;!&ndash; Ïä§ÌÅ¨Î°§ &ndash;&gt;-->
<!--                            <div class="d-flex" style="height:530px;">-->

<!--                                <div class="col-md-4 mb-4 d-inline-block" style="width: 340px; margin-right: 20px;" data-th-each="entry : ${groupedSchedules}"> &lt;!&ndash; Ïó¨Î∞± Ï∂îÍ∞Ä &ndash;&gt;-->
<!--                                <h5 class="mb-3 text" data-th-text="${entry.key} + 'ÏùºÏ∞®'">ÏùºÏ∞®</h5>-->

<!--                                <div class="timeline">-->
<!--                                    <div class="timeline-item mb-2" data-th-each="schedule, iter : ${entry.value}" data-th-object="${schedule}">-->
<!--                                        <div class="p-3 border rounded shadow-sm d-flex justify-content-between align-items-start">-->
<!--                                            &lt;!&ndash; ÏùºÏ†ï Ï†ïÎ≥¥ &ndash;&gt;-->
<!--                                            <div class="me-3">-->
<!--                                                <div class="d-flex align-items-center mb-2">-->
<!--                                                    <div class="badge bg-warning text-white" style="font-size: 1.25rem; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;" data-th-text="${iter.index + 1}">ÏùºÏ†ï ÏàúÏÑú</div>-->
<!--                                                    <div class="ms-2">-->
<!--                                                        <p class="mb-1 text-primary" data-th-text="*{location.locationName}">ÏàôÏÜå</p>-->
<!--                                                    </div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                            &lt;!&ndash; Ïù¥ÎØ∏ÏßÄ &ndash;&gt;-->
<!--                                            <div>-->
<!--                                                <img data-th-src="${schedule.location.locationPhoto != null ? schedule.location.locationPhoto : 'https://via.placeholder.com/70x70'}"-->
<!--                                                     alt="Location Photo" class="img-thumbnail" style="width: 70px; height: 70px;">-->
<!--                                            </div>-->
<!--                                        </div>-->
<!--                                        &lt;!&ndash; ÌÉÄÏûÑÎùºÏù∏ Ï†êÏÑ†Í≥º ÏãúÍ∞Ñ Ï†ïÎ≥¥ &ndash;&gt;-->
<!--                                        <div class="d-flex align-items-baseline">-->
<!--                                            <div class="timeline-line mt-2" style="border-left: 2px dotted #ddd; height: 20px; margin-left: 20px;"></div>-->
<!--                                            <div class="text-muted small ms-2"><i class="bi bi-car-front"></i> 45Î∂Ñ</div>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->


        <div class="mb-2">
            <textarea readonly class="form-control border-0 p-2" style="resize: none; overflow: hidden; font-size: 1rem;" data-th-text="${board.boardContent}" oninput="this.style.height = ''; this.style.height = this.scrollHeight + 'px';">ÎÇ¥Ïö©</textarea>
        </div>

        <div class="mb-2">
            <input readonly type="text" class="form-control border-0 p-2" style="font-size: 1rem;" data-th-value="${board.boardTag}">
        </div>

        <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-secondary" data-th-onclick="|location.href='@{list}'|">Î™©Î°ù</button>
        </div>
    </form>
</div>

<div data-th-replace="~{question/comment}"></div>

<!-- ÏÉÅÎã® Ïù¥Îèô Î≤ÑÌäº -->
<button id="scrollTopButton" onclick="scrollToTop()" class="btn btn-secondary btn-sm" style="position: fixed; bottom: 20px; left: 77%; transform: translateX(-50%); visibility: hidden; padding: 7px 10px;">
    <i class="bi bi-arrow-up"></i> ÏÉÅÎã®ÏúºÎ°ú Ïù¥Îèô
</button>

<script defer>
    function toggleLike(boardNo) {
    fetch(`/question/toggleLike?boardNo=${boardNo}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById('likeCount').textContent = data.likeCount;
        document.getElementById('likeButton').textContent = data.isLiked ? '‚ù§Ô∏è Ï¢ãÏïÑÏöî Ï∑®ÏÜå' : 'ü§ç Ï¢ãÏïÑÏöî';
        alert(data.message);
    })
    .catch(error => console.error('Error:', error));
}

function toggleFavor(boardNo) {
    fetch(`/question/toggleFavor?boardNo=${boardNo}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById('favorCount').textContent = data.favorCount;
        document.getElementById('favorButton').textContent = data.isFavored ? '‚≠ê Ï¶êÍ≤®Ï∞æÍ∏∞ Ï∑®ÏÜå' : '‚ö™ Ï¶êÍ≤®Ï∞æÍ∏∞';
        alert(data.message);
    })
    .catch(error => console.error('Error:', error));
}
</script>

<script>
    // ÏÉÅÎã® Ïù¥Îèô Ìï®Ïàò
   function scrollToTop() {
       window.scrollTo({ top: 0, behavior: 'smooth' });
   }

   // Ïä§ÌÅ¨Î°§ Ïù¥Î≤§Ìä∏ Í∞êÏßÄÌïòÏó¨ Î≤ÑÌäº ÌëúÏãú
   window.addEventListener('scroll', function() {
       const scrollTopButton = document.getElementById('scrollTopButton');
       if (window.scrollY > 500) {
           scrollTopButton.style.visibility = "visible";
       } else {
           scrollTopButton.style.visibility = "hidden";
       }
   });
</script>

</body>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</html>